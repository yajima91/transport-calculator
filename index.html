<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JITBOXãƒãƒ£ãƒ¼ã‚¿ãƒ¼ä¾¿æ–™é‡‘ã€€è‡ªå‹•è¨ˆç®—</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0f1117;
    --surface: #1a1d27;
    --surface2: #22263a;
    --border: #2e3350;
    --accent: #4f8ef7;
    --accent2: #7c5cfc;
    --success: #3dd68c;
    --warn: #f7c94f;
    --text: #e8eaf6;
    --muted: #7b82a8;
    --radius: 14px;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Noto Sans JP', sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 40px 16px 80px;
  }

  /* Header */
  header {
    text-align: center;
    margin-bottom: 40px;
  }
  .logo-mark {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    font-family: 'DM Mono', monospace;
    font-size: 12px;
    color: var(--accent);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 16px;
    background: rgba(79,142,247,.10);
    padding: 6px 14px;
    border-radius: 100px;
    border: 1px solid rgba(79,142,247,.25);
  }
  h1 {
    font-size: clamp(24px, 5vw, 36px);
    font-weight: 700;
    background: linear-gradient(135deg, #fff 30%, var(--accent));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1.25;
  }
  .subtitle {
    color: var(--muted);
    font-size: 14px;
    margin-top: 8px;
  }

  /* Card */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 28px;
    width: 100%;
    max-width: 520px;
  }
  .card + .card { margin-top: 16px; }

  /* Setup Banner */
  #setup-banner {
    background: linear-gradient(135deg, rgba(79,142,247,.15), rgba(124,92,252,.15));
    border: 1px solid rgba(79,142,247,.3);
    border-radius: var(--radius);
    padding: 20px 24px;
    max-width: 520px;
    width: 100%;
    margin-bottom: 16px;
  }
  #setup-banner h3 { font-size: 14px; color: var(--accent); margin-bottom: 8px; }
  #setup-banner input {
    width: 100%;
    background: rgba(0,0,0,.3);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 12px;
    color: var(--text);
    font-size: 13px;
    font-family: 'DM Mono', monospace;
    margin-top: 8px;
  }
  #setup-banner input:focus { outline: none; border-color: var(--accent); }

  /* Form */
  .form-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 14px;
  }
  .form-group { display: flex; flex-direction: column; gap: 6px; }
  .form-group.full { grid-column: 1 / -1; }

  /* ç™ºåœ°å›ºå®šãƒãƒƒã‚¸ */
  .origin-fixed {
    display: flex;
    align-items: center;
    gap: 10px;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 14px;
    font-size: 15px;
    font-weight: 700;
    color: var(--text);
  }
  .origin-fixed .badge {
    font-size: 11px;
    font-weight: 500;
    color: var(--accent);
    background: rgba(79,142,247,.12);
    border: 1px solid rgba(79,142,247,.25);
    border-radius: 6px;
    padding: 2px 8px;
    letter-spacing: .05em;
  }
  label { font-size: 12px; color: var(--muted); font-weight: 500; letter-spacing: .05em; }
  select, input[type="number"] {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 14px;
    color: var(--text);
    font-size: 15px;
    font-family: 'Noto Sans JP', sans-serif;
    appearance: none;
    transition: border-color .2s;
    width: 100%;
  }
  select:focus, input[type="number"]:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(79,142,247,.15);
  }
  select option { background: #1a1d27; }

  /* Button */
  .btn {
    width: 100%;
    padding: 15px;
    border: none;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 700;
    font-family: 'Noto Sans JP', sans-serif;
    cursor: pointer;
    transition: all .2s;
    margin-top: 20px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: #fff;
    letter-spacing: .05em;
  }
  .btn:hover { opacity: .9; transform: translateY(-1px); box-shadow: 0 8px 24px rgba(79,142,247,.3); }
  .btn:active { transform: translateY(0); }
  .btn:disabled { opacity: .5; cursor: not-allowed; transform: none; }
  .btn-clear {
    width: 100%;
    padding: 13px;
    border: 1px solid var(--border);
    border-radius: 10px;
    font-size: 15px;
    font-weight: 600;
    font-family: 'Noto Sans JP', sans-serif;
    cursor: pointer;
    transition: all .2s;
    margin-top: 14px;
    background: transparent;
    color: var(--muted);
    letter-spacing: .05em;
  }
  .btn-clear:hover { background: var(--surface2); color: var(--text); border-color: var(--muted); }

  /* Result */
  #result-card { display: none; }
  #result-card.show { display: block; }

  .result-header {
    font-size: 12px;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: .1em;
    margin-bottom: 18px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .result-header::before {
    content: '';
    display: block;
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--success);
    box-shadow: 0 0 8px var(--success);
  }

  .route-display {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
    padding: 14px 16px;
    background: var(--surface2);
    border-radius: 10px;
    font-size: 15px;
    font-weight: 500;
  }
  .route-sep { color: var(--accent); font-size: 20px; flex-shrink: 0; }

  .breakdown {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 20px;
  }
  .breakdown-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
  }
  .breakdown-row .label { color: var(--muted); }
  .breakdown-row .value { font-family: 'DM Mono', monospace; }
  .breakdown-row.packing .value { color: var(--accent); }
  .divider {
    height: 1px;
    background: var(--border);
    margin: 4px 0;
  }
  .total-row {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    padding: 16px 18px;
    background: linear-gradient(135deg, rgba(79,142,247,.1), rgba(124,92,252,.1));
    border: 1px solid rgba(79,142,247,.2);
    border-radius: 10px;
  }
  .total-label { font-size: 13px; color: var(--muted); }
  .total-amount {
    font-family: 'DM Mono', monospace;
    font-size: 28px;
    font-weight: 500;
    color: var(--success);
  }

  /* Spinner */
  .spinner {
    display: inline-block;
    width: 18px; height: 18px;
    border: 2px solid rgba(255,255,255,.3);
    border-top-color: #fff;
    border-radius: 50%;
    animation: spin .7s linear infinite;
    vertical-align: middle;
    margin-right: 8px;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* Error */
  .error-box {
    background: rgba(239,68,68,.1);
    border: 1px solid rgba(239,68,68,.3);
    border-radius: 10px;
    padding: 14px 16px;
    font-size: 14px;
    color: #f87171;
    margin-top: 12px;
    display: none;
  }
  .error-box.show { display: block; }

  /* Load btn */
  .load-btn {
    margin-top: 10px;
    padding: 8px 16px;
    border: 1px solid var(--accent);
    border-radius: 8px;
    background: transparent;
    color: var(--accent);
    font-size: 13px;
    font-family: 'Noto Sans JP', sans-serif;
    cursor: pointer;
    transition: all .2s;
  }
  .load-btn:hover { background: rgba(79,142,247,.1); }

  .section-title {
    font-size: 13px;
    font-weight: 700;
    color: var(--text);
    margin-bottom: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .section-title span {
    background: var(--surface2);
    padding: 2px 10px;
    border-radius: 100px;
    font-size: 11px;
    color: var(--muted);
    font-weight: 400;
  }


  /* QRã‚¹ã‚­ãƒ£ãƒŠãƒ¼ */
  .qr-btn {
    margin-top: 10px;
    margin-left: 8px;
    padding: 8px 14px;
    border: 1px solid var(--accent);
    border-radius: 8px;
    background: transparent;
    color: var(--accent);
    font-size: 13px;
    font-family: 'Noto Sans JP', sans-serif;
    cursor: pointer;
    transition: all .2s;
    vertical-align: middle;
  }
  .qr-btn:hover { background: rgba(79,142,247,.1); }

  #qr-modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.85);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    gap: 16px;
  }
  #qr-modal.show { display: flex; }
  #qr-modal h3 { color: #fff; font-size: 16px; font-family: 'Noto Sans JP', sans-serif; }
  #qr-video-wrap {
    position: relative;
    width: 300px;
    height: 300px;
    border-radius: 16px;
    overflow: hidden;
    border: 2px solid var(--accent);
  }
  #qr-video { width: 100%; height: 100%; object-fit: cover; }
  #qr-overlay {
    position: absolute;
    inset: 0;
    border: 40px solid rgba(0,0,0,.4);
    border-radius: 16px;
    box-shadow: inset 0 0 0 2px var(--accent);
  }
  #qr-close {
    padding: 10px 28px;
    border: 1px solid #fff;
    border-radius: 8px;
    background: transparent;
    color: #fff;
    font-size: 14px;
    font-family: 'Noto Sans JP', sans-serif;
    cursor: pointer;
  }
  #qr-status { color: var(--muted); font-size: 13px; font-family: 'Noto Sans JP', sans-serif; }

  @media (max-width: 480px) {
    .card { padding: 20px; }
  }
</style>
</head>
<body>

<header>
  <div class="logo-mark">ğŸšš JITBOX Charter</div>
  <h1>JITBOXãƒãƒ£ãƒ¼ã‚¿ãƒ¼ä¾¿æ–™é‡‘ã€€è‡ªå‹•è¨ˆç®—</h1>
  <p class="subtitle">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è‡ªå‹•ã§æ–™é‡‘ã‚’ç®—å‡º</p>
</header>

<!-- GAS URLè¨­å®šãƒãƒŠãƒ¼ -->
<div id="setup-banner">
  <h3>âš™ï¸ åˆå›è¨­å®šï¼šGoogle Apps Script ã® URL ã‚’å…¥åŠ›</h3>
  <p style="font-size:13px; color: var(--muted);">URLã‚’è²¼ã‚Šä»˜ã‘ã‚‹ã‹ã€QRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ãã ã•ã„</p>
  <input type="url" id="gas-url-input" placeholder="https://script.google.com/macros/s/xxxxx/exec" />
  <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;">
    <button class="load-btn" onclick="loadMaster()">ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€</button>
    <button class="qr-btn" onclick="openQR()">ğŸ“· QRã‚³ãƒ¼ãƒ‰ã§èª­ã¿è¾¼ã‚€</button>
  </div>
</div>

<!-- QRã‚¹ã‚­ãƒ£ãƒŠãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="qr-modal">
  <h3>ğŸ“· GAS URLã®QRã‚³ãƒ¼ãƒ‰ã‚’ã‚«ãƒ¡ãƒ©ã«æ˜ ã—ã¦ãã ã•ã„</h3>
  <div id="qr-video-wrap">
    <video id="qr-video" autoplay playsinline muted></video>
    <div id="qr-overlay"></div>
  </div>
  <p id="qr-status">ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•ä¸­...</p>
  <button id="qr-close" onclick="closeQR()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
</div>

<!-- ãƒ¡ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ  -->
<div class="card">
  <div class="section-title">è¨ˆç®—æ¡ä»¶ã®å…¥åŠ› <span>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ãŒåæ˜ ã•ã‚Œã¾ã™</span></div>

  <div class="form-grid">
    <div class="form-group">
      <label>ç™ºåœ°ï¼ˆFROMï¼‰</label>
      <div class="origin-fixed">
        <span>æ„›çŸ¥çœŒ</span>
        <span class="badge">å›ºå®š</span>
      </div>
    </div>

    <div class="form-group">
      <label>ç€åœ°ã‚¨ãƒªã‚¢ï¼ˆTOï¼‰</label>
      <select id="destination">
        <option value="">-- ãƒã‚¹ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„ --</option>
      </select>
    </div>

    <div class="form-group">
      <label>å€‹æ•°ï¼ˆå£æ•°ï¼‰</label>
      <input type="number" id="quantity" value="1" min="1" max="9999" />
    </div>
  </div>

  <div class="error-box" id="error-box"></div>
  <button class="btn" id="calc-btn" onclick="calculate()" disabled>è¨ˆç®—ã™ã‚‹</button>
</div>

<!-- çµæœã‚«ãƒ¼ãƒ‰ -->
<div class="card" id="result-card">
  <div class="result-header">è¨ˆç®—çµæœ</div>

  <div class="route-display">
    <span id="res-origin">-</span>
    <span class="route-sep">âœˆ</span>
    <span id="res-dest">-</span>
  </div>

  <div class="breakdown">
    <div class="breakdown-row">
      <span class="label">è¼¸é€è²»ï¼ˆ1å€‹ã‚ãŸã‚Šï¼‰</span>
      <span class="value" id="res-base">-</span>
    </div>
    <div class="breakdown-row">
      <span class="label">å€‹æ•°</span>
      <span class="value" id="res-qty">-</span>
    </div>
    <div class="breakdown-row">
      <span class="label">è¼¸é€è²»å°è¨ˆ</span>
      <span class="value" id="res-transport-total">-</span>
    </div>
    <div class="divider"></div>
    <div class="breakdown-row packing">
      <span class="label" id="res-packing-label">æ¢±åŒ…è²»</span>
      <span class="value" id="res-packing-total">-</span>
    </div>
  </div>

  <div class="total-row">
    <span class="total-label">åˆè¨ˆï¼ˆè¼¸é€è²» ï¼‹ æ¢±åŒ…è²»ï¼‰ç¨æŠœ</span>
    <span class="total-amount" id="res-total">-</span>
  </div>
  <button class="btn-clear" onclick="clearResult()">ğŸ”„ ã‚¯ãƒªã‚¢ã—ã¦å†è¨ˆç®—</button>
</div>

<script>

  // ========================================
  // QRã‚³ãƒ¼ãƒ‰ã‚¹ã‚­ãƒ£ãƒŠãƒ¼
  // ========================================
  let qrStream = null;
  let qrTimer = null;

  async function openQR() {
    const modal = document.getElementById('qr-modal');
    const video = document.getElementById('qr-video');
    const status = document.getElementById('qr-status');
    modal.classList.add('show');
    status.textContent = 'ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•ä¸­...';

    try {
      qrStream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: 'environment' } // èƒŒé¢ã‚«ãƒ¡ãƒ©å„ªå…ˆ
      });
      video.srcObject = qrStream;
      status.textContent = 'QRã‚³ãƒ¼ãƒ‰ã‚’ã‚«ãƒ¡ãƒ©ã«æ˜ ã—ã¦ãã ã•ã„';
      startQRScan(video, status);
    } catch (e) {
      status.textContent = 'ã‚«ãƒ¡ãƒ©ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
    }
  }

  function startQRScan(video, status) {
    // BarcodeDetector APIï¼ˆChrome/Edgeå¯¾å¿œï¼‰
    if (!('BarcodeDetector' in window)) {
      status.textContent = 'ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯QRã‚¹ã‚­ãƒ£ãƒ³ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚URLã‚’æ‰‹å‹•ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
      return;
    }

    const detector = new BarcodeDetector({ formats: ['qr_code'] });
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');

    qrTimer = setInterval(async () => {
      if (video.readyState !== video.HAVE_ENOUGH_DATA) return;
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      ctx.drawImage(video, 0, 0);

      try {
        const codes = await detector.detect(canvas);
        if (codes.length > 0) {
          const url = codes[0].rawValue;
          if (url.startsWith('https://script.google.com')) {
            document.getElementById('gas-url-input').value = url;
            closeQR();
            status.textContent = 'QRã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚ŠæˆåŠŸï¼';
            loadMaster(); // è‡ªå‹•ã§ãƒã‚¹ã‚¿èª­ã¿è¾¼ã¿é–‹å§‹
          } else {
            status.textContent = 'âš ï¸ GASã®QRã‚³ãƒ¼ãƒ‰ã§ã¯ã‚ã‚Šã¾ã›ã‚“';
          }
        }
      } catch(e) {}
    }, 300);
  }

  function closeQR() {
    const modal = document.getElementById('qr-modal');
    modal.classList.remove('show');
    if (qrStream) {
      qrStream.getTracks().forEach(t => t.stop());
      qrStream = null;
    }
    if (qrTimer) {
      clearInterval(qrTimer);
      qrTimer = null;
    }
  }

  // ========================================
  // â˜… GAS URLï¼ˆä¿å­˜ãƒ»èª­ã¿è¾¼ã¿ï¼‰
  // ========================================
  const GAS_URL_KEY = 'transport_gas_url';
  let masterData = null;

  // èµ·å‹•æ™‚ã«LocalStorageã‹ã‚‰URLå¾©å…ƒ
  window.addEventListener('DOMContentLoaded', () => {
    const saved = localStorage.getItem(GAS_URL_KEY);
    if (saved) {
      document.getElementById('gas-url-input').value = saved;
    }
  });

  async function loadMaster() {
    const url = document.getElementById('gas-url-input').value.trim();
    if (!url) { showError('URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }

    localStorage.setItem(GAS_URL_KEY, url);
    showError('');

    const btn = document.querySelector('.load-btn');
    btn.disabled = true;
    btn.textContent = 'èª­ã¿è¾¼ã¿ä¸­...';

    try {
      const res = await fetch(`${url}?action=getMaster`);
      const data = await res.json();

      if (data.error) throw new Error(data.error);

      masterData = data;
      populateSelects(data);
      document.getElementById('calc-btn').disabled = false;
      btn.textContent = 'âœ“ èª­ã¿è¾¼ã¿å®Œäº†';
      btn.style.borderColor = 'var(--success)';
      btn.style.color = 'var(--success)';
    } catch (e) {
      showError('ãƒã‚¹ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + e.message);
      btn.textContent = 'ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€';
      btn.disabled = false;
    }
  }

  // ç™ºåœ°ã¯æ„›çŸ¥çœŒã§å›ºå®š
  const FIXED_ORIGIN = 'æ„›çŸ¥çœŒ';

  function populateSelects(data) {
    const destSel = document.getElementById('destination');
    destSel.innerHTML = '<option value="">ç€åœ°ã‚’é¸æŠã—ã¦ãã ã•ã„</option>';
    data.destinations.forEach(d => {
      destSel.innerHTML += `<option value="${d}">${d}</option>`;
    });
  }

  async function calculate() {
    const origin = FIXED_ORIGIN;
    const destination = document.getElementById('destination').value;
    const quantity = document.getElementById('quantity').value;

    showError('');
    if (!destination) { showError('ç€åœ°ã‚¨ãƒªã‚¢ã‚’é¸æŠã—ã¦ãã ã•ã„'); return; }
    if (!quantity || quantity < 1) { showError('å€‹æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }

    const gasUrl = localStorage.getItem(GAS_URL_KEY);
    const btn = document.getElementById('calc-btn');
    btn.disabled = true;
    btn.innerHTML = '<span class="spinner"></span>è¨ˆç®—ä¸­...';

    try {
      const res = await fetch(`${gasUrl}?action=calculate&origin=${encodeURIComponent(origin)}&destination=${encodeURIComponent(destination)}&quantity=${quantity}`);
      const data = await res.json();

      if (data.error) throw new Error(data.error);
      renderResult(data);
    } catch (e) {
      showError('è¨ˆç®—ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + e.message);
    }

    btn.disabled = false;
    btn.innerHTML = 'è¨ˆç®—ã™ã‚‹';
  }

  function renderResult(d) {
    const fmt = n => 'Â¥' + Number(n).toLocaleString();

    document.getElementById('res-origin').textContent = d.origin;
    document.getElementById('res-dest').textContent = d.destination;
    document.getElementById('res-base').textContent = fmt(d.baseFee);
    document.getElementById('res-qty').textContent = d.quantity + ' å€‹';
    document.getElementById('res-packing-label').textContent = `æ¢±åŒ…è²»ï¼ˆ${fmt(d.packingFeePerUnit)} Ã— ã‚«ã‚´æ•°ï¼‰`;
    document.getElementById('res-transport-total').textContent = fmt(d.transportTotal);
    document.getElementById('res-packing-total').textContent = fmt(d.packingTotal);
    document.getElementById('res-total').textContent = fmt(d.total);

    const card = document.getElementById('result-card');
    card.classList.add('show');
    card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

  function clearResult() {
    // çµæœã‚«ãƒ¼ãƒ‰ã‚’éè¡¨ç¤º
    const card = document.getElementById('result-card');
    card.classList.remove('show');

    // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
    document.getElementById('destination').value = '';
    document.getElementById('quantity').value = '1';

    // ã‚¨ãƒ©ãƒ¼ã‚‚ã‚¯ãƒªã‚¢
    showError('');

    // ç€åœ°é¸æŠæ¬„ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
    document.getElementById('destination').focus();

    // ç”»é¢ãƒˆãƒƒãƒ—ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function showError(msg) {
    const box = document.getElementById('error-box');
    box.textContent = msg;
    box.classList.toggle('show', !!msg);
  }
</script>
</body>
</html>
